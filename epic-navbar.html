<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../polymer/polymer.html">
<link rel="stylesheet" href="css/style.css">

<!--
A functional clone of the zealoptics.com navbar

Example:

    <epic-navbar></epic-navbar>

@demo
-->
<dom-module id="epic-navbar">

  <style>
    :host {
      display: block;
      box-sizing: border-box;
    }
  </style>

  <template>
    <nav id="newNav" class="navbar" role="navigation">
        <div class="nav-container">
            <div class="left-menu">
                <a href="#" id="openSlideMenu">
                    <img src="img/icn-mobile-nav.svg">
                </a>
            </div>
            <div class="search-and-country">
                <!-- search -->
                <a href="#" id="nav-search">
                    <img src="img/search_img.svg">
                    <img class="active-triangle" src="img/menu_active.svg">
                </a>
                
                <form id="input_ZOSearchBoxComponent" method="get" action="//www.zealoptics.com/en/search/">
                    <input type="text" id="searchInput" placeholder="Search" name="text" maxlength="100">
                    <a href="#" id="search-delete">X</a>
                    <input type="submit" value="">
                </form>
                
                <!-- country -->
                <a href="#" id="nav-country">
                    <img src="img/country-img.svg">
                    <span>USA&nbsp;(EN)</span>
                </a>
                
                <ul id="desktop-country-selector">
                    <li>
                        <a href="//ca.zealoptics.com/en">
                        Canada 
                        <span class="language">(English)</span>
                        </a>
                    </li>
                    <li>
                        <a href="//www.zealoptics.com/en">
                        United States 
                        <span class="language">(English)</span>
                        </a>
                    </li>
                </ul>
            </div>
            <ul class="nav-left">
                <li>
                    <a href="#" id="nav-shop">
                        Shop
                        <img class="active-triangle" src="img/menu_active.svg">
                    </a>
                    <ul class="drop-down">
                        <li>
                            <a href="//www.zealoptics.com/en/shop/sunglasses?all=true">
                                <img src="img/sunglasses-dropdown.jpg">
                                <span>Sunglasses</span>
                            </a>
                        </li>
                        <li>
                            <a href="//www.zealoptics.com/en/shop/goggles?all=true">
                                <img src="img/goggles-dropdown.jpg">
                                <span>Goggles</span>
                            </a>
                        </li>
                        <li>
                            <a href="//www.zealoptics.com/en/shop/accessory-lenses">
                                <img src="img/shop3.png">
                                <span>Accessory Lenses</span>
                            </a>
                        </li>
                        <li>
                            <a href="//www.zealoptics.com/en/shop/accessories">
                                <img src="img/shop4.png">
                                <span>Accessories</span>
                            </a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#" id="nav-technology">
                        Technology
                        <img class="active-triangle" src="img/menu_active.svg">
                    </a>
                    <ul class="drop-down">
                        <li>
                            <a href="//www.zealoptics.com/en/sunglass-technology">
                                <img src="img/shop1.png">
                                <span>Sunglass Technology</span>
                            </a>
                        </li>
                        <li>
                            <a href="//www.zealoptics.com/en/goggle-tech">
                                <img src="img/shop2.png">
                                <span>Goggle Technology</span>
                            </a>
                        </li>
                        <li>
                            <a href="//www.zealoptics.com/en/passport-page">
                                <img src="img/prescription-dropdown.jpg">
                                <span>Prescription</span>
                            </a>
                        </li>
                    </ul>
                </li>
            </ul>
            <div class="logo">
                <!-- logo -->
                <a class="navbar-logo" href='http://www.zealoptics.com/en/'>
                    <div class="content"><img src="img/brand-logo.svg" alt=""></div>
                </a>
            </div>
            <ul class="nav-right">
                <li>
                    <a href="#" id="nav-our-story">
                        Our Story
                        <img class="active-triangle" src="img/menu_active.svg">
                    </a>
                    <ul class="drop-down">
                        <li>
                            <a href="//www.zealoptics.com/en/who-we-are">
                                <img src="img/whoweare-dropdown.jpg">
                                <span>Who We Are</span>
                            </a>
                        </li>
                        <li>
                            <a href="//www.zealoptics.com/en/ambassador-page">
                                <img src="img/ambassadors-dropdown.jpg">
                                <span>Ambassadors</span>
                            </a>
                        </li>
                        <li>
                            <a href="//www.zealoptics.com/en/community-page">
                                <img src="img/community-dropdown.jpg">
                                <span>Community</span>
                            </a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#" id="nav-explore-more">
                        Explore More
                        <img class="active-triangle" src="img/menu_active.svg">
                    </a>
                    <ul class="drop-down">
                        <li>
                            <a href="//www.zealoptics.com/en/who-we-are">
                                <img src="img/blog-dropdown.jpg">
                                <span>Blog</span>
                            </a>
                        </li>
                        <li>
                            <a href="//www.zealoptics.com/en/ambassador-page">
                                <img src="img/events-dropdown.jpg">
                                <span>Events</span>
                            </a>
                        </li>
                        <li>
                            <a href="//www.zealhd.com">
                                <img src="img/zealhd-dropdown.jpg">
                                <span>ZealHD.com</span>
                            </a>
                        </li>
                    </ul>
                </li>
            </ul>
            <div class="account-and-cart">
                <a href="//www.zealoptics.com/en/login" id="nav-account" title="Login/My Account">User</a>
                <a href="//www.zealoptics.com/en/cart" id="nav-cart" title="My Cart">Cart</a>
            </div>
        </div>
        <ul class="slide-menu">
            <li>
                <form method="get" action="//www.zealoptics.com/en/search/">
                    <input type="search" placeholder="Search" name="text">
                    <input type="submit">
                </form>
            </li>
            <li>
                <a href="#">Shop</a>
                <ul>
                    <li>
                        <a href="//www.zealoptics.com/en/shop/sunglasses?all=true">Sunglasses</a>
                    </li>
                    <li>
                        <a href="//www.zealoptics.com/en/shop/goggles?all=true">Goggles</a>
                    </li>
                    <li>
                        <a href="//www.zealoptics.com/en/shop/accessory-lenses">Accessory Lenses</a>
                    </li>
                    <li>
                        <a href="//www.zealoptics.com/en/shop/accessories">Accessories</a>
                    </li>
                </ul>
            </li>
            <li>
                <a href="#">Technology</a>
                <ul>
                    <li>
                        <a href="//www.zealoptics.com/en/sunglass-technology">Sunglass Technology</a>
                    </li>
                    <li>
                        <a href="//www.zealoptics.com/en/goggle-tech">Goggle Technology</a>
                    </li>
                    <li>
                        <a href="//www.zealoptics.com/en/passport-page">Prescription</a>
                    </li>
                </ul>
            </li>
            <li>
                <a href="#">Our Story</a>
                <ul>
                    <li>
                        <a href="//www.zealoptics.com/en/who-we-are">Who We Are</a>
                    </li>
                    <li>
                        <a href="//www.zealoptics.com/en/ambassador-page">Ambassadors</a>
                    </li>
                    <li>
                        <a href="//www.zealoptics.com/en/community-page">Community</a>
                    </li>
                </ul>
            </li>
            <li>
                <a href="#">Explore More</a>
                <ul>
                    <li>
                        <a href="//blog.zealoptics.com/">Blog</a>
                    </li>
                    <li>
                        <a href="//www.zealoptics.com/en/events">Events</a>
                    </li>
                    <li>
                        <a href="//www.zealhd.com/">ZealHD.com</a>
                    </li>
                </ul>
            </li>
            <li>
                <a href="//www.zealoptics.com/en/login" class="no-arrow">Login</a>
            </li>
            <li class="country">
                <a href="#">
                    <img src="img/country-img.svg">
                    <span>USA &nbsp;(EN)</span>
                </a>
                <ul>
                    <li>
                        <a href="//ca.zealoptics.com/en">CANADA (English)</a>
                        <a href="//www.zealoptics.com/en">UNITED STATES (English)</a>
                    </li>
                </ul>
            </li>
        </ul>
    </nav>
  </template>

</dom-module>

<script src="js/jquery-2.1.4.min.js"></script>
<script>

  Polymer({

    is: 'epic-navbar',

    properties: {
        // none for now
    },

    // Element Lifecycle

    ready: function() {
      // `ready` is called after all elements have been configured, but
      // propagates bottom-up. This element's children are ready, but parents
      // are not.
      //
      // This is the point where you should make modifications to the DOM (when
      // necessary), or kick off any processes the element wants to perform.

        // close side bar on window resize
        $(window)
            .on('resize', function() {
            $('.navbar').removeClass('slide-active');
        })
            .on('scroll', function() {
                if( $(window).width() > 991 && $(window).scrollTop() > $('.nav-container').height() ) {
                    $('.nav-container').addClass('fixed');
                }
                else {
                    $('.nav-container').removeClass('fixed');
                }
        });

        // top-level desktop nav
        $('.nav-container > ul > li > a').click(function(e) {
            e.preventDefault();

            // close search
            $('#nav-search').parent().removeClass('open-search').removeClass('open-country');

            // open this drop-down
            if($(this).parent().hasClass('open')) {
                $(this).parent().removeClass('open');
            }
            else{
                // close other drop-downs
                $('.nav-container > ul > li').removeClass('open');

                // open this drop-down
                $(this).parent().addClass('open');
            }
        });

        // open side menu
        $('#openSlideMenu').click(function(e) {
            e.preventDefault();

            $('.navbar').toggleClass('slide-active');

            // close sub-menus
            $('.slide-menu > li > ul').slideUp();
            $('.slide-menu > li > a').removeClass('open');
        });

        // side menu sub-menus
        $('.slide-menu > li > a').click(function(e) {
            e.preventDefault();

            if ($(this).hasClass('open')) {
                $(this).siblings('ul').slideUp();
                $(this).removeClass('open');
            }
            else {
                $(this).siblings('ul').slideDown();
                $(this).addClass('open');
            }

            // close other sub-menus
            $(this).parent().siblings().children('ul').slideUp();
            $(this).parent().siblings().children('a').removeClass('open');
        });

        // desktop search
        $('#nav-search').click(function(e) {
            e.preventDefault();

            // close menu sub-menus
            $('.nav-container > ul > li').removeClass('open');

            $(this).parent().toggleClass('open-search').removeClass('open-country');

            if($(this).parent().hasClass('open-search')) {
                $('#searchInput').focus();
            }
            else{
                $('#searchInput').blur();
            }
        });

        // desktop country selector
        $('#nav-country').click(function(e) {
            e.preventDefault();
            $('.nav-container > ul > li').removeClass('open');
            $(this).parent().toggleClass('open-country').removeClass('open-search');
        });

        // bind input clear x
        $('a#search-delete').click(function(e) {
            e.preventDefault();

            $('#input_ZOSearchBoxComponent #searchInput').val('').focus();
        });
    },

    attached: function() {
      // `attached` fires once the element and its parents have been inserted
      // into a document.
      //
      // This is a good place to perform any work related to your element's
      // visual state or active behavior (measuring sizes, beginning animations,
      // loading resources, etc).
    },

    detached: function() {
      // The analog to `attached`, `detached` fires when the element has been
      // removed from a document.
      //
      // Use this to clean up anything you did in `attached`.
        $('.nav-container > ul > li > a').off('click');
        $('#openSlideMenu').off('click');
        $('.slide-menu > li > a').off('click');
        $('#nav-search').off('click');
        $('a#search-delete').off('click');
    },

    // Element Behavior
  });

</script>
